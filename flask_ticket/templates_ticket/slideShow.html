{% extends "layout_ticket.html" %}

{% block BODY %}
<h5 id="title1" style="text-align: center;"></h5>
<h3 id="title2" style="text-align: center;"></h3>

<div id="imageCarousel" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner" id="carouselInner"></div>

    <a class="carousel-control-prev" href="#imageCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </a>
    <a class="carousel-control-next" href="#imageCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </a>
</div>

<script>
    const images = {{images|tojson}};
    const carouselInner = document.getElementById("carouselInner");

    // カルーセルに画像を追加
    images[1].forEach((imgData, idx) => {
        const div = document.createElement("div");
        div.className = "carousel-item" + (idx === 0 ? " active" : "");

        const img = document.createElement("img");
        img.src = "https://raw.githubusercontent.com/kouki-0926/FlaskMathOnHeroku_Images/main/picture/" + imgData[1];
        img.className = "d-block mx-auto";
        img.style.maxHeight = "60vh";

        div.appendChild(img);
        carouselInner.appendChild(div);
    });

    // 最初のタイトル表示
    document.getElementById("title1").innerText = images[1][0][0] + " " + images[0] + " 1/" + images[1].length;
    document.getElementById("title2").innerText = images[1][0][2];

    // スライドイベントでタイトルを更新
    $('#imageCarousel').on('slide.bs.carousel', function (e) {
        const index = $(e.relatedTarget).index();
        document.getElementById("title1").innerText = images[1][index][0] + " " + images[0] + " " + (index + 1) + "/" + images[1].length;
        document.getElementById("title2").innerText = images[1][index][2];
    });
</script>

{% endblock %}